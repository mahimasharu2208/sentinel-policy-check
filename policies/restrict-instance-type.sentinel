import "tfplan/v2" as tfplan

# Safely grab aws_instance resources, or an empty list if none exist
instances = tfplan.planned_values.resources.aws_instance else []

# Rule: every aws_instance must be t2.micro
main = rule {
    all instances as _, r {
        r.values.instance_type is "t2.micro"
    }
}

